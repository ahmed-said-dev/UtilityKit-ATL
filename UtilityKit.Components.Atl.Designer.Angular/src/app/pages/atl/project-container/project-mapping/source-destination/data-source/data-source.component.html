<div class="card bg-transparent px-4 h-50">
  <div class="card-header border-0 p-0 h-40px mh-40px">
    <!--begin::Page title-->
    <div class="d-flex">
      <h1
        class="page-heading d-flex align-items-center text-dark fw-bold fs-4 justify-content-center my-0 text-capitalize"
      >
        Data Sources
        <span *ngIf="!schemaConnected" class="ms-3 fs-7 text-muted">
          (No Sources Connected)
        </span>
        <span *ngIf="schemaConnected" class="ms-3 fs-7 text-muted">
          (
          {{
            addSchemaToATLResponce.length > 1
              ? addSchemaToATLResponce.length + " Sources Connected"
              : addSchemaToATLResponce.length + " Source Connected"
          }}
          )
        </span>
      </h1>
    </div>
    <div class="d-flex align-items-center">
      <!--begin::Primary button-->
      <a
        class="btn btn-flex btn-sm btn-outline btn-secondary fw-bold"
        data-kt-menu-trigger="click"
        data-kt-menu-placement="bottom-end"
        placement="left"
        ngbTooltip="Add New Source"
      >
        <i class="fa-solid fa-plus me-2"></i>
        Add Source
      </a>
      <div
        class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light fw-semibold w-200px py-4"
        data-kt-menu="true"
      >
        <!--begin::Menu item-->
        <div class="menu-item">
          <a
            class="menu-link px-4 btn btn-sm btn-active-light text-hover-primary fs-7"
            (click)="openSchema()"
          >
            <span
              [inlineSVG]="'./assets/media/icons/duotune/source-types/gdb.svg'"
              class="svg-icon svg-icon-1 me-2"
            ></span>
            Geodatabase (.gdb)</a
          >
        </div>
        <!--end::Menu item-->
        <!--begin::Menu item-->
        <div class="menu-item">
          <a
            class="menu-link px-4 btn btn-sm btn-active-light text-hover-primary fs-7"
            (click)="openGDB()"
          >
            <span
              [inlineSVG]="'./assets/media/icons/duotune/source-types/xml.svg'"
              class="svg-icon svg-icon-1 me-2"
            ></span
            >Schema (XML)</a
          >
        </div>
        <!--end::Menu item-->
        <!--begin::Menu item-->
        <div class="menu-item">
          <a
            class="menu-link px-4 btn btn-sm btn-active-light text-hover-primary fs-7"
            (click)="openCAD()"
          >
            <span
              [inlineSVG]="'./assets/media/icons/duotune/source-types/cad.svg'"
              class="svg-icon svg-icon-1 me-2"
            ></span
            >CAD File</a
          >
        </div>
        <!--end::Menu item-->
        <!--begin::Menu item-->
        <div class="menu-item">
          <a
            class="menu-link px-4 btn btn-sm btn-active-light text-hover-primary fs-7"
            (click)="openShape()"
          >
            <span
              [inlineSVG]="
                './assets/media/icons/duotune/source-types/shape.svg'
              "
              class="svg-icon svg-icon-1 me-2"
            ></span
            >Shape File</a
          >
        </div>
        <!--end::Menu item-->
        <!--begin::Menu item-->
        <div class="menu-item">
          <a
            class="menu-link px-4 btn btn-sm btn-active-light text-hover-primary fs-7"
            (click)="openOracle()"
          >
            <span
              [inlineSVG]="
                './assets/media/icons/duotune/source-types/oracle.svg'
              "
              class="svg-icon svg-icon-1 me-2"
            ></span
            >Oracle DB</a
          >
        </div>
        <!--end::Menu item-->
        <!--begin::Menu item-->
        <div class="menu-item">
          <a
            class="menu-link px-4 btn btn-sm btn-active-light text-hover-primary fs-7"
            (click)="openSchema()"
          >
            <span
              [inlineSVG]="'./assets/media/icons/duotune/source-types/sql.svg'"
              class="svg-icon svg-icon-1 me-2"
            ></span
            >SQL DB</a
          >
        </div>
        <!--end::Menu item-->
      </div>
      <!--end::Primary button-->
    </div>
    <!--end::Page title-->
  </div>
  <div class="card-body p-3 overflow-auto" style="height: calc(100% - 50px)">
    <div [ngClass]="schemaConnected ? 'd-none' : ''">
      <div class="row">
        <div class="col-lg-4 col-sm-6 mb-3">
          <a
            (click)="openGDB()"
            class="btn btn-outline btn-outline-primary btn-sm btn-active-color-primary border border-primary border-hover-primary border-hover-2 btn-flex flex-column overflow-hidden h-xl-100px d-flex justify-content-center"
          >
            <!--begin::Icon-->
            <span
              [inlineSVG]="'./assets/media/icons/duotune/files/file-schema.svg'"
              class="svg-icon svg-icon-primary svg-icon-2tx mb-3"
            ></span>

            <!--end::Icon-->

            <!--begin::Title-->
            <span class="fw-semibold fs-8"> Schema .XML </span>
            <!--end::Title-->
          </a>
        </div>
        <div class="col-lg-4 col-sm-6 mb-3">
          <a
            (click)="openSchema()"
            class="btn btn-outline btn-outline-primary btn-sm btn-active-color-primary border border-primary border-hover-primary border-hover-2 btn-flex flex-column overflow-hidden h-xl-100px d-flex justify-content-center"
          >
            <!--begin::Icon-->
            <span
              [inlineSVG]="'./assets/media/icons/duotune/files/file-gdb.svg'"
              class="svg-icon svg-icon-primary svg-icon-2tx mb-3"
            ></span>

            <!--end::Icon-->

            <!--begin::Title-->
            <span class="fw-semibold fs-8"> Geodatabase File </span>
            <!--end::Title-->
          </a>
        </div>
        <div class="col-lg-4 col-sm-6 mb-3">
          <a
            (click)="openShape()"
            class="btn btn-outline btn-outline-primary btn-sm btn-active-color-primary border border-primary border-hover-primary border-hover-2 btn-flex flex-column overflow-hidden h-xl-100px d-flex justify-content-center"
          >
            <!--begin::Icon-->
            <span
              [inlineSVG]="'./assets/media/icons/duotune/files/file-shape.svg'"
              class="svg-icon svg-icon-primary svg-icon-2tx mb-3"
            ></span>

            <!--end::Icon-->

            <!--begin::Title-->
            <span class="fw-semibold fs-8"> Shape File </span>
            <!--end::Title-->
          </a>
        </div>
        <div class="col-lg-4 col-sm-6">
          <a
            (click)="openCAD()"
            class="btn btn-outline btn-outline-primary btn-sm btn-active-color-primary border border-primary border-hover-primary border-hover-2 btn-flex flex-column overflow-hidden h-xl-100px d-flex justify-content-center"
          >
            <!--begin::Icon-->
            <span
              [inlineSVG]="'./assets/media/icons/duotune/files/file-cad.svg'"
              class="svg-icon svg-icon-primary svg-icon-2tx mb-3"
            ></span>

            <!--end::Icon-->

            <!--begin::Title-->
            <span class="fw-semibold fs-8"> CAD File </span>
            <!--end::Title-->
          </a>
        </div>
        <div class="col-lg-4 col-sm-6">
          <a
            (click)="openOracle()"
            class="btn btn-outline btn-outline-primary btn-sm btn-active-color-primary border border-primary border-hover-primary border-hover-2 btn-flex flex-column overflow-hidden h-xl-100px d-flex justify-content-center"
          >
            <!--begin::Icon-->
            <span
              [inlineSVG]="'./assets/media/icons/duotune/files/file-oracle.svg'"
              class="svg-icon svg-icon-primary svg-icon-2tx mb-3"
            ></span>

            <!--end::Icon-->

            <!--begin::Title-->
            <span class="fw-semibold fs-8"> Oracle File </span>
            <!--end::Title-->
          </a>
        </div>
        <div class="col-lg-4 col-sm-6">
          <a
            (click)="openSQL()"
            class="btn btn-outline btn-outline-primary btn-sm btn-active-color-primary border border-primary border-hover-primary border-hover-2 btn-flex flex-column overflow-hidden h-xl-100px d-flex justify-content-center"
          >
            <!--begin::Icon-->
            <span
              [inlineSVG]="'./assets/media/icons/duotune/files/file-sql.svg'"
              class="svg-icon svg-icon-primary svg-icon-2tx mb-3"
            ></span>

            <!--end::Icon-->

            <!--begin::Title-->
            <span class="fw-semibold fs-8"> SQL File </span>
            <!--end::Title-->
          </a>
        </div>
      </div>
    </div>

    <div [ngClass]="schemaConnected ? '' : 'd-none'">
      <div
        class="card card-bordered mb-4"
        *ngFor="
          let Schema of addSchemaToATLResponce;
          let highlightedDataSource = index
        "
      >
        <div class="card-body p-4">
          <div class="d-flex flex-wrap align-items-center flex-sm-nowrap">
            <div class="flex-grow-1">
              <div
                class="d-flex justify-content-between align-items-center align-content-center flex-wrap"
              >
                <div
                  class="d-flex flex-wrap align-items-start flex-sm-nowrap flex-column grow-1"
                >
                  <h4 class="mb-4 text-dark fs-6">
                    <span
                      [inlineSVG]="
                        './assets/media/icons/duotune/source-types/xml.svg'
                      "
                      class="svg-icon svg-icon-2x me-2"
                    ></span>
                    {{ Schema.dataSource.name }}
                  </h4>

                  <div class="d-flex align-items-center mb-2">
                    <i class="fa-solid fa-table-list me-4"></i>

                    <div class="text-gray-800 fs-8">
                      No. of Tables
                      <span class="fw-bold text-primary"
                        >({{ Schema.dataSource.tablesCount }})</span
                      >
                    </div>
                  </div>
                  <div class="d-flex align-items-center">
                    <span
                      [inlineSVG]="
                        './assets/media/icons//duotune/aside/featureclass.svg'
                      "
                      class="svg-icon svg-icon-2 me-3"
                    ></span>
                    <div class="text-gray-800 fs-8">
                      No. of Feature Classes
                      <span class="fw-bold text-primary"
                        >({{ Schema.dataSource.featureClassesCount }})</span
                      >
                    </div>
                  </div>
                </div>
                <div class="d-flex">
                  <a
                    class="btn btn-icon btn-light-secondary btn-color-gray-800 btn-sm me-2"
                    placement="left"
                    ngbTooltip="View Catalog"
                    [class.active]="
                      highlightedDataSourceRow === highlightedDataSource
                    "
                    (click)="
                      openViewCatalog(
                        Schema.dataSource.dataSourceSchemaJson,
                        highlightedDataSource
                      )
                    "
                  >
                    <span
                      [inlineSVG]="
                        './assets/media/icons/duotune/text/txt009.svg'
                      "
                      class="svg-icon svg-icon-2"
                    ></span>
                  </a>

                  <a
                    class="btn btn-icon btn-light-secondary btn-color-gray-800 btn-sm"
                    placement="left"
                    ngbTooltip="Disconnect"
                    (click)="
                      handleDisconnectDataSource(
                        Schema.dataSource.id,
                        Schema.dataSource.name,
                        Schema.hasMapRecord
                      )
                    "
                  >
                    <span
                      [inlineSVG]="
                        './assets/media/icons/duotune/coding/cod008.svg'
                      "
                      class="svg-icon svg-icon-2"
                    ></span>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- childrens -->
<app-schema-data-source
  #schemaDataSource
  (connectSchema)="handleSchemaConnect()"
></app-schema-data-source>

<app-cad-data-source
  #cadDataSource
  (connectSchema)="handleSchemaConnect()"
></app-cad-data-source>
